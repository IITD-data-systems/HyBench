SELECT rev_actor, COUNT(*) AS cou
FROM (
    SELECT page_id
    FROM page
    WHERE page_len<{len} AND
    ((page_embedding {op} '{q}' BETWEEN {d_1} AND {d_1*})
    OR (page_embedding {op} '{q}' BETWEEN {d_2} AND {d_2*})
    OR .. OR (page_embedding {op} '{q}' BETWEEN {d_n} AND {d_n*}))
) AS filtered_page
JOIN revision ON page_id = rev_page
GROUP BY rev_actor
ORDER BY cou DESC;